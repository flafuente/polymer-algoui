<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-app.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-auth.html">

<dom-module id="firebase-login">
    <template>
      <style include="shared-styles">
      :host {
            display: block;
            max-height:300px;
            min-width:350px;
            overflow-y:auto;
            float:left;
          }
      </style>

      <firebase-app auth-domain="algoui-69c5c.firebaseapp.com"
        database-url="https://algoui-69c5c.firebaseio.com"
        api-key="AIzaSyCu4SjjxeFv_Ee7vyonAtRGCUvFNOMNmzY">
      </firebase-app>
      <firebase-auth id="auth" user="{{user}}" status-known="{{statusKnown}}" on-error="_showError">
      </firebase-auth>

      <div class="error" hidden$="[[!error]]">[[error.code]]: [[error.message]]</div>

      <div hidden$="[[user]]">
        <h3>Email/Password</h3>
        <form on-submit="signInWithEmailAndPassword">
          <input value="{{email::input}}" type="email" placeholder="Email">
          <input value="{{password::input}}" type="password" placeholder="Password">
          <button type="submit" on-tap="_signInWithEmailAndPassword">Sign In</button>
          <button type="button" on-tap="createUserWithEmailAndPassword">Sign Up</button>
        </form>
      </div>
      
    </template>

    <script>
        Polymer({
            is: 'firebase-login',
            properties: {
              output: {
                type: Array,
                reflectToAttribute: true,
                notify: true,
              },
              user: {
                type: Object,
                observer: '_userChanged'
              }

          },
          _userChanged: function (user) {
            console.log("User Object", user);
          },
          _showError: function (e) {
            this.error = e.detail;
          },
          _signInWithEmailAndPassword: function (e) {
            if (e) { e.preventDefault(); }
            this.error = null;
            this.$.auth.signInWithEmailAndPassword(this.email, this.password);
            this.email = null;
            this.password = null;

          },



          ready: function () {
            this.output = {"firebase-login":[]};
            this.error = null;
            // var app = this;
            // var auth = this.$.auth;
            // app.error = null;
            // app.showError = function(e) {
            //   this.error = e.detail;
            // };
            // app.signInAnonymously = function() {
            //   this.error = null;
            //   auth.signInAnonymously();
            // };
            // app.signInWithGoogle = function() {
            //   this.error = null;
            //   auth.signInWithPopup();
            // };
            // app.signInWithEmailAndPassword = function(e) {
            //   if (e) { e.preventDefault(); }
            //   this.error = null;
            //   auth.signInWithEmailAndPassword(this.email, this.password);
            //   this.email = null;
            //   this.password = null;
            // };
            // app.createUserWithEmailAndPassword = function() {
            //   this.error = null;
            //   auth.createUserWithEmailAndPassword(this.email, this.password);
            //   this.email = null;
            //   this.password = null;
            //         debugger;
            // }
            // app.signOut = function() {
            //   this.error = null;
            //   auth.signOut();
            // };
          }
        });
    </script>
</dom-module>
